# 1. General

This Github-Repository is divided into two parts. The first part is a python script that enumerates MR-chordless circuits in randomly generated bipartite graphs. The second is autogatito, which is an 
exension of autogato (https://github.com/hollyritch/autogato) and currently located here due to revision and publication purposes. During the review process reviewers should be able to focus only on autogatito 
which is therefore separated from the main autogato repository. The moment autogatito is accepted for publication the extensions will be integrated into autogato as a new development branch and an updated
version of autogato released. For now, autogatito is maintained here and contains the core implementation of autogato. 

We start with the python script for enumerating MR-Chordless circuits.

# 2. MR-Chordless Circuit Enumeration

The handling is fairly easy. If you want to test the script, just install the following packages, conveniently in a new conda environment with python 3.13:

- Networkx
- matplotlib
- NumPy

For simple enumeration of random graphs run: 

# python mrChordlessCircuit.py <k> <m> <n>

where m/n is the ratio of metabolite to reactions and k*m therefore specifies the number of metabolites and k*n the number of reactions. Thus 10 2 1 will 
produce graphs with 2*10 = 20 metabolites and 1*10 = 10 reactions vertices. The number of vertices increase by k*(n+m) (30 in the example) for 5 iterations, thus, MR-ChordlessCircuits and also elementary circuits will be enumerated in graphs of sizes 30, 60, 90, 120, 
and 150 in the exmple. This procedure is done for 5 different edge-probabilities, i.e. 0.5%, 1.0%, 1.5%, 2.0%, and 2.5%. Be aware that especially for larger graphs and higher edge-probabilites elementary circuits grow super-exponentially in their size
and may require long computation times. Output will be saved into a separate folder called benchmarking with subdirectories named after the ratio of metabolites to reactions. 

To enumerate MR-chordless circuits on fluffles, choose the option ear. In this case, provide first the number of ears that you maximally want to have attached and then the maximum length of an ear. An example call is:

# python mrChordlessCircuits.py 10 20 ears

In this example an elementary circuit will be attached with a maximum of 10 ears of maximum size 20. However, the algorithm will generate all combinations, i.e. starts with an elemenatry circuit to which 1 ear of max. size 2 is attached, 
then 1 ear of max-size 2, etc. The maximum is then a fluffle with 10 ears of which each is of max. size 20.

# 3. Autogatio

Autogatito is a python package designed to compute all autocatalytic cores in metabolic networks upto a given size. As autogato (see https://github.com/hollyritch/autogato) it consists of the following modules:

- partitionNetwork.py
- partitionNetworkHelper.py
- partitionComputations.py
- partitionNetwork.py
- partitionAnalysis.py
- setup.py
- checkMatch.pyx

It takes sbml-models as input works for BIGG-Models and all other SBML-3 models. In the usage section we describe how to use the programme. We also provide a testscript for comuting autocatalytic cores for the e_coli_core model. 
Linux and Mac systems are now supported due to usage of ProcessPoolExecutor or ThreadPoolExecture. 

# 2. Installation and Setup

Prior to usage, setup a new conda environment with Python 3 (preferably 3.13 work fine) and install the following packages:

- SymPy
- NumPy
- SciPy
- NetowrkX
- libsbml
- tqdm
- Cython

Clone the git, activate your conda environment, and first perform the following command:

python setup.py build_ext --inplace

to compile checkMatch.pyx so that it can be imported as a normal in all partitionAnalysis.py

# 3. Usage

## 3.1 Partition the Network

First call partition Network via the following command:

- python partitionNetwork.py -i <InputXMLFile> or - python partitionNetwork.py -input <InputXMLFile>

You can provide additional options:
- -t or --threads <Number of Threads>  : Number of threads for parallel processing, default=2
- -o or --ouptur <OutDir>              : specify the directory for saving the .pkl-files, default: "./Output"
- -s or --smallMolecules <FileName>    : Specify list of species identifier for molecules that need to be removed from the network (see ./SmallMolecules/smallMoleculesEColiCore.txt for                                          an example)
- -c or --cutOff <cutOffValue>         : Minimum size of a module (a reaction network) - in terms of number of reactions - that is generated by the partitioning algorithm, default=2.

If the network decomposes into multiple strongly connected components, each of these components larger than the defined cutoff will generate a .pkl-outputfile.

## 3.2 Analyse the partitioned network

Secondly, you partition the network by using the output from the first

- python partitionAnalysis.py -x < XMLFile > -i < inputPickleFile > -s < Species >

Again you have multiple options:

- -b or --circuitBound <Max. Length elementary circuits> 
  Specify the maximum length of elementary circuits as length=len(metabolites)+len(reactions), default = 20. Unbounded search can be enforced by setting circuitBound = 2*(min(len(metabolites), len(reactions)). But be carefull due to very high memory consumption for larger networks.
- -n or --nonMetzler <True/False>
    Specify if you want non-Metzler matrices to be investigated for autocatalycity or not. Default = True. This only make sense if core == False
- -t or --threads   <Number of Threads> 
    Number of threads for parallel processing, default=2. Makes only sense if -p is set.
- -e or --equivClassBound <Max. length Equiv.Clases>
    Maximum length of equivalance classes gnerated via superimposition of elementary circuits in terms of length=len(metabolites)+len(reactions) of the Equivalence class
- -f or --fluffle
    Will enforce enumeration of fluffles. Be very carefull to do that. Memory consumption explodes very quickly. Default = False.
- -c or --cores
    Enumerates only cores. Recommended to apply first to larger networks. Consumes significantly less memory than normal mode. 
- p or --parallel
    If you want elementary circuits and assembly of larger equivalence classes parallelized, enforce -p. Default is false.
-o or --ouput <OutputDir>
    Provide output directory. Default = "./cycleData"

# Important for enumerating cores: Do use -c or --cores otherwise autogato is called which will enumerate all irreducible autocatalytic subsystems.

## 3.3 Test usage

To get familiar with the package, open test.py and modify the variables provided and call it via:

python test.py

You can add or modify the different parameters to see the specifics for your system.

     
